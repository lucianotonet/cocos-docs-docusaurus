"use strict";(self.webpackChunkcocos_docs_docusaurus=self.webpackChunkcocos_docs_docusaurus||[]).push([[3535],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},s=Object.keys(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,c=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),d=l(n),m=r,h=d["".concat(c,".").concat(m)]||d[m]||u[m]||s;return n?o.createElement(h,i(i({ref:t},p),{},{components:n})):o.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=m;var a={};for(var c in t)hasOwnProperty.call(t,c)&&(a[c]=t[c]);a.originalType=e,a[d]="string"==typeof e?e:r,i[1]=a;for(var l=2;l<s;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},46991:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var o=n(87462),r=(n(67294),n(3905));const s={},i="Extension Infrastructure",a={unversionedId:"editor/extension/package",id:"editor/extension/package",title:"Extension Infrastructure",description:"Before writing an extension, we first need to understand the infrastructure of extensions within Cocos Creator.",source:"@site/docs/editor/extension/package.md",sourceDirName:"editor/extension",slug:"/editor/extension/package",permalink:"/zh/docs/editor/extension/package",draft:!1,editUrl:"https://github.com/cocos/cocos-docs/docs/editor/extension/package.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Message System",permalink:"/zh/docs/editor/extension/messages"},next:{title:"Creating a Custom Panel",permalink:"/zh/docs/editor/extension/panel-boot"}},c={},l=[{value:"Electron",id:"electron",level:2},{value:"Multi-process Mechanism",id:"multi-process-mechanism",level:2},{value:"Inter-process Communication",id:"inter-process-communication",level:2},{value:"Capabilities of extensions",id:"capabilities-of-extensions",level:2}],p={toc:l},d="wrapper";function u(e){let{components:t,...s}=e;return(0,r.kt)(d,(0,o.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"extension-infrastructure"},"Extension Infrastructure"),(0,r.kt)("p",null,"Before writing an extension, we first need to understand the infrastructure of extensions within Cocos Creator."),(0,r.kt)("h2",{id:"electron"},"Electron"),(0,r.kt)("p",null,"The Cocos Creator editor is based on the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/atom/electron"},"Electron")," kernel from GitHub."),(0,r.kt)("p",null,"Electron is a cross-platform development framework that integrates with ",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/"},"Node.js")," and ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/chromium/chromium"},"Google Chromium"),"."),(0,r.kt)("h2",{id:"multi-process-mechanism"},"Multi-process Mechanism"),(0,r.kt)("p",null,"In Electron's architecture, an application consists of a main process and a rendering process, with the main process managing platform-related scheduling, such as window opening and closing, menu options, basic dialogs, and so on. Each newly opened window is a separate rendering process. Each process has its own JavaScript content and is not directly accessible to each other. When data needs to be passed between processes, the Inter-Process Communication (IPC) mechanism is used."),(0,r.kt)("p",null,"You can read ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/atom/electron/blob/master/docs/tutorial/quick-start.md"},"Electron's introduction document")," for a more in-depth understanding of the features The relationship between the main process and the rendering process in Electron."),(0,r.kt)("p",null,"To put it simply, the main process in Electron is equivalent to a Node.js server application, while each window (rendering process) is equivalent to a client-side web application."),(0,r.kt)("p",null,"The Cocos Creator editor follows the structure of Electron's main process and rendering process. So when the extension is started and run inside the editor, the main defined by the extension is actually started in the main process, while the panels defined by the panels are started in the rendering process. The process structure is briefly summarized as follows."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"electron-process",src:n(90867).Z,width:"988",height:"408"})),(0,r.kt)("h2",{id:"inter-process-communication"},"Inter-process Communication"),(0,r.kt)("p",null,"Inter-process communication is actually the process of sending a message in one process and listening to it in another process."),(0,r.kt)("p",null,"Electron provides modules ",(0,r.kt)("inlineCode",{parentName:"p"},"ipcMain")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"ipcRenderer")," for inter-process communication to help us with this task."),(0,r.kt)("p",null,"Since these two modules only perform very basic communication functions and do not satisfy the communication needs between the editor, extension panel and the main process, Cocos Creator wraps this and extends the method of sending and receiving messages between processes to make it easier for extension developers and editor developers to create more complex scenarios. For more details, please see the documentation ",(0,r.kt)("a",{parentName:"p",href:"/zh/docs/editor/extension/messages"},"Message System"),"."),(0,r.kt)("h2",{id:"capabilities-of-extensions"},"Capabilities of extensions"),(0,r.kt)("p",null,"With a full Node.js environment inside the extension, it is easy to use the large number of tools available on the npm marketplace for the functionality you want."),(0,r.kt)("p",null,"If you need to interact with other features, you need to open up the corresponding operation messages for the corresponding features, and we do this within our own extension, via ",(0,r.kt)("a",{parentName:"p",href:"/zh/docs/editor/extension/messages"},"Message System")," to trigger, query and process functions or data in the editor."),(0,r.kt)("p",null,"The list of opened messages can be viewed in the top menu ",(0,r.kt)("strong",{parentName:"p"},"Developer -> Message Manager")," panel, as shown below."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"extension-message-mgr-menu",src:n(84308).Z,width:"800",height:"331"})),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"extension-message-mgr-panel",src:n(19295).Z,width:"800",height:"550"})))}u.isMDXComponent=!0},90867:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/electron-process-5c667d5693f3419650de501ed13c9a21.png"},84308:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/extension-message-mgr-menu-fd858faa0b6895025c8f353ec9f9ec8a.png"},19295:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/extension-message-mgr-panel-6b3b72f52409aae7e1cf4bd9cbd6e9c4.png"}}]);