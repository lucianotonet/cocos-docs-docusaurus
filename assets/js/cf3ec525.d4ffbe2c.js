"use strict";(self.webpackChunkcocos_docs_docusaurus=self.webpackChunkcocos_docs_docusaurus||[]).push([[5404],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>h});var i=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=i.createContext({}),p=function(e){var n=i.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=p(e.components);return i.createElement(l.Provider,{value:n},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},u=i.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=p(t),u=o,h=c["".concat(l,".").concat(u)]||c[u]||m[u]||a;return t?i.createElement(h,r(r({ref:n},d),{},{components:t})):i.createElement(h,r({ref:n},d))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,r=new Array(a);r[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[c]="string"==typeof e?e:o,r[1]=s;for(var p=2;p<a;p++)r[p]=t[p];return i.createElement.apply(null,r)}return i.createElement.apply(null,t)}u.displayName="MDXCreateElement"},19526:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>m,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var i=t(87462),o=(t(67294),t(3905));const a={},r="Getting Started Example - Menu",s={unversionedId:"editor/extension/first",id:"editor/extension/first",title:"Getting Started Example - Menu",description:"This article will demonstrate how to create a Cocos Creator extension, and it will cover the following points.",source:"@site/docs/editor/extension/first.md",sourceDirName:"editor/extension",slug:"/editor/extension/first",permalink:"/docs/editor/extension/first",draft:!1,editUrl:"https://github.com/cocos/cocos-docs/docs/editor/extension/first.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Getting Started Example - Panel",permalink:"/docs/editor/extension/first-panel"},next:{title:"Multilingual System (i18n)",permalink:"/docs/editor/extension/i18n"}},l={},p=[{value:"Create and Install Extensions",id:"create-and-install-extensions",level:2},{value:"Extension Manager",id:"extension-manager",level:2},{value:"Extended Directory",id:"extended-directory",level:2},{value:"Extension Definition File <code>package.json</code>",id:"extension-definition-file-packagejson",level:2},{value:"Define Menus and Messages",id:"define-menus-and-messages",level:2},{value:"Installing Dependencies and Compiling",id:"installing-dependencies-and-compiling",level:2},{value:"Run Extensions",id:"run-extensions",level:2},{value:"Entry Program <code>main.ts</code>",id:"entry-program-maints",level:2},{value:"Menu Message Handling",id:"menu-message-handling",level:2}],d={toc:p},c="wrapper";function m(e){let{components:n,...a}=e;return(0,o.kt)(c,(0,i.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"getting-started-example---menu"},"Getting Started Example - Menu"),(0,o.kt)("p",null,"This article will demonstrate how to create a Cocos Creator extension, and it will cover the following points."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Creating an extension"),(0,o.kt)("li",{parentName:"ul"},"Adding a menu"),(0,o.kt)("li",{parentName:"ul"},"Menu Messages")),(0,o.kt)("h2",{id:"create-and-install-extensions"},"Create and Install Extensions"),(0,o.kt)("p",null,"Find the ",(0,o.kt)("strong",{parentName:"p"},"Extension -> Create")," menu in the editor's menu bar, as shown below:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"create-extension-menu",src:t(59246).Z,width:"600",height:"147"})),(0,o.kt)("p",null,"After clicking ",(0,o.kt)("strong",{parentName:"p"},"Create"),", the creation panel will pop up as shown below:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"create-extension-panel",src:t(23434).Z,width:"512",height:"614"})),(0,o.kt)("p",null,"Cocos Creator provides 4 extension templates as shown above for quickly creating a new extension project."),(0,o.kt)("p",null,"To demonstrate the template creation process more simply, let's select the ",(0,o.kt)("strong",{parentName:"p"},"Blank")," template and click the ",(0,o.kt)("strong",{parentName:"p"},"Create Extension")," button at the bottom right of the panel to build an extension package."),(0,o.kt)("p",null,"For more template creation related content, please refer to the document ",(0,o.kt)("a",{parentName:"p",href:"/docs/editor/extension/create-extension"},"Extension Templates and Compile Builds - Template Types"),"."),(0,o.kt)("h2",{id:"extension-manager"},"Extension Manager"),(0,o.kt)("p",null,"After the extension is successfully created, click ",(0,o.kt)("strong",{parentName:"p"},"Extensions-> Extension Manager -> Project/Global")," in the top menu bar, you can see the extension you just created. The newly created extension is not enabled by default, click the Enable button to enable this extension."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"extension",src:t(32098).Z,width:"527",height:"313"})),(0,o.kt)("p",null,"For more information about extension management, please refer to the documentation ",(0,o.kt)("a",{parentName:"p",href:"/docs/editor/extension/extension-manager#Extensions%20list"},"Extension Manager - Extension List"),"."),(0,o.kt)("h2",{id:"extended-directory"},"Extended Directory"),(0,o.kt)("p",null,"Click the ",(0,o.kt)("img",{alt:"folder",src:t(3796).Z,width:"20",height:"20"})," button to open the directory where the extensions are located. Take the ",(0,o.kt)("strong",{parentName:"p"},"Blank")," template as an example, the directory structure is as follows:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"extension-folder",src:t(58971).Z,width:"600",height:"493"})),(0,o.kt)("p",null,"The function of each subfile (folder) is as follows."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"@types")," - TypeScript definition file."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"dist")," - TypeScript-generated javascript code."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"i18n")," - Multilanguage configuration."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"src")," - TypeScript source code."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"package.json")," - The extension description file."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"README-CN/EN.md")," - Chinese/English description file."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"tsconfig.json")," - TypeScript configuration file.")),(0,o.kt)("h2",{id:"extension-definition-file-packagejson"},"Extension Definition File ",(0,o.kt)("inlineCode",{parentName:"h2"},"package.json")),(0,o.kt)("p",null,"Each extension needs a ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," file to describe the purpose of the extension."),(0,o.kt)("p",null,"Only after the complete definition of the description file ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json"),", the editor will be able to know the specific functionality, loading entry and other information defined in the extension."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Note"),": Although many of the fields in ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," are defined similarly to ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," of the ",(0,o.kt)("inlineCode",{parentName:"p"},"node.js")," npm module, the npm module downloaded from the npm community cannot be used directly as a Cocos Creator extension. You can call the npm module from within the Cocos Creator extension to make the extension capable of doing so.")),(0,o.kt)("p",null,"Open the ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," file and you will see the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "package_version": 2,\n    "version": "1.0.0",\n    "name": "simple-1649426645745",\n    "description": "i18n:simple-1649426645745.description",\n    "main": "./dist/main.js",\n    "devDependencies": {\n        "@types/node": "^16.0.1",\n        "typescript": "^4.3.4"\n    },\n    "author": "Cocos Creator",\n    "editor": ">=3.4.2",\n    "scripts": {\n        "build": "tsc -b",\n        "watch": "tsc -w"\n    }\n}\n\n')),(0,o.kt)("p",null,"The description of each field is as follows."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"package_version"),": Number - the value of the version number."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"version"),": String - The version number string, it is recommended to use ",(0,o.kt)("a",{parentName:"li",href:"http://semver.org/"},"semver")," format to manage your package version."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"name"),": String - defines the name of the package, the package name is globally unique. Please refer to ","[option description]"," for naming rules (. /create-extension.md)."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"description"),": Stirng - Extension description, used to briefly introduce the key features, usage and other information of the extension, supports ",(0,o.kt)("strong",{parentName:"li"},"i18n")," multi-language settings."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"main"),": String - The entry program file."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"devDependencies"),": {} - Extension dependencies. In this example, the extension depends on NodeJS version 16.0.1 and TypeScript version 4.3.4."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"author"),": String - Author information."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"editor"),": String - the supported Cocos Creator editor version."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"scripts"),": {} - Script compilation related commands.")),(0,o.kt)("h2",{id:"define-menus-and-messages"},"Define Menus and Messages"),(0,o.kt)("p",null,"Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," with the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "package_version": 2,\n    "version": "1.0.0",\n    "name": "simple-1649426645745",\n    "description": "i18n:simple-1649426645745.description",\n    "main": "./dist/main.js",\n    "devDependencies": {\n        "@types/node": "^16.0.1",\n        "typescript": "^4.3.4"\n    },\n    "author": "Cocos Creator",\n    "editor": ">=3.4.2",\n    "scripts": {\n        "build": "tsc -b",\n        "watch": "tsc -w"\n    },\n    //------------------------------\n    "contributions": {\n        "menu": [{\n            "path": "Develop",\n            "label": "test",\n            "message": "log"\n        }],\n        "messages": {\n            "log": {\n                "methods": ["log"]\n            }\n        }\n    }\n}\n')),(0,o.kt)("p",null,"The description of the new fields is as follows."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"contributions"),": Object (optional) - configuration related to the extension of the editor's existing functionality",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"menu"),": [], register the menu and bind the message. For details, please refer to ",(0,o.kt)("a",{parentName:"li",href:"/docs/editor/extension/contributions-menu"},"Customize the Main Menu"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"messages"),":[] - Register editor messages, which can be bound to one or more methods defined within the extension. See ",(0,o.kt)("a",{parentName:"li",href:"/docs/editor/extension/contributions-messages"},"Customized Messages")," for more definition data.")))),(0,o.kt)("p",null,"For more definitions of the ",(0,o.kt)("inlineCode",{parentName:"p"},"package.json")," format, please refer to ",(0,o.kt)("a",{parentName:"p",href:"/docs/editor/extension/define"},"Definition of Extension"),"."),(0,o.kt)("h2",{id:"installing-dependencies-and-compiling"},"Installing Dependencies and Compiling"),(0,o.kt)("p",null,"After the extension is created, open the directory where the extension package is located and execute the following command."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# install dependencies\nnpm install\n# build\nnpm run build\n")),(0,o.kt)("p",null,"For more information on building extensions, see the documentation ",(0,o.kt)("a",{parentName:"p",href:"/docs/editor/extension/create-extension"},"Extension Templates and Compile Builds"),"."),(0,o.kt)("h2",{id:"run-extensions"},"Run Extensions"),(0,o.kt)("p",null,"Go back to the editor and click ",(0,o.kt)("strong",{parentName:"p"},"Extension -> Extension Manager -> Project/Global")," in the top menu bar and find the extension you created earlier. Click on the ",(0,o.kt)("img",{alt:"refresh",src:t(98781).Z,width:"20",height:"20"})," button on the right side of the extension to make the above changes take effect."),(0,o.kt)("p",null,"If the extension has taken effect, a ",(0,o.kt)("strong",{parentName:"p"},"Develop")," menu will appear in the top menu bar area of Cocos Creator with a ",(0,o.kt)("strong",{parentName:"p"},"test")," menu item, as shown below."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"menu-test",src:t(69927).Z,width:"786",height:"160"})),(0,o.kt)("p",null,"If you click on the ",(0,o.kt)("strong",{parentName:"p"},"test")," menu item, you will see that there is no response, because we have not yet written the code for the menu information."),(0,o.kt)("p",null,"Next, we will see how to make the menu communicate with the extension."),(0,o.kt)("h2",{id:"entry-program-maints"},"Entry Program ",(0,o.kt)("inlineCode",{parentName:"h2"},"main.ts")),(0,o.kt)("p",null,"Each extension has a unique entry program ",(0,o.kt)("inlineCode",{parentName:"p"},"main.ts"),", which is generated by default as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"/**\n * @en Registration method for the main process of Extension\n * @zh \u4e3a\u6269\u5c55\u7684\u4e3b\u8fdb\u7a0b\u7684\u6ce8\u518c\u65b9\u6cd5\n */\nexport const methods: { [key: string]: (...any: any) => any } = { };\n\n/**\n * @en Hooks triggered after extension loading is complete\n * @zh \u6269\u5c55\u52a0\u8f7d\u5b8c\u6210\u540e\u89e6\u53d1\u7684\u94a9\u5b50\n */\nexport const load = function() { };\n\n/**\n * @en Hooks triggered after extension uninstallation is complete\n * @zh \u6269\u5c55\u5378\u8f7d\u5b8c\u6210\u540e\u89e6\u53d1\u7684\u94a9\u5b50\n */\nexport const unload = function() { };\n")),(0,o.kt)("p",null,"The methods defined in ",(0,o.kt)("inlineCode",{parentName:"p"},"export const methods")," will be used as interfaces for operations that will be called across extensions via the ",(0,o.kt)("a",{parentName:"p",href:"/docs/editor/extension/messages"},"Message System")," to be called across extensions or to communicate with panels."),(0,o.kt)("p",null,"The entry program is the main process of the extension and will be loaded during the startup of Cocos Creator."),(0,o.kt)("h2",{id:"menu-message-handling"},"Menu Message Handling"),(0,o.kt)("p",null,"We modify the entry program slightly by adding a handler function that receives ",(0,o.kt)("inlineCode",{parentName:"p"},"log")," messages, as follows."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"export const methods: { [key: string]: (.. . any: any) => any } = { \n    log(){console.log('Hello World')},\n};\n")),(0,o.kt)("p",null,"Execute the ",(0,o.kt)("inlineCode",{parentName:"p"},"npm run build")," command to compile the extension."),(0,o.kt)("p",null,"Click on the ",(0,o.kt)("img",{alt:"refresh",src:t(98781).Z,width:"20",height:"20"})," button on the right side of the extension to make the above changes take effect."),(0,o.kt)("p",null,"Click the ",(0,o.kt)("inlineCode",{parentName:"p"},"Develop/test"),' menu item again and you will see that "Hello World" is printed out in the Cocos Creator ',(0,o.kt)("strong",{parentName:"p"},"console"),"."))}m.isMDXComponent=!0},69927:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/extension-menu-test-55525aec7dd063be8f3873a2dba6d1ab.png"},32098:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/extension-a78ebee3f2f21a377af376fa0c3024f1.png"},3796:(e,n,t)=>{t.d(n,{Z:()=>i});const i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAD7SURBVDiNY9TX12cgFzCRrXNANbMgc/jk1CS4oOxvL249+UC0ZvHAigpnGVY4//eTvd0d658Rp9lKHUknAwMDq4yOk9rVMwgBTLegOBsNiFvk5Vkg8THcQkqAscqoWxJn8++fv7EI/iKk+fujQytn7XghAQ94ZKCmpsHA8Pvj47svv2Nq/v1k77TVDOG1bTLsuNzEwPD7/ubC3p3ofv50dfWMlx6pzvh0Mny6unLaTgYGBhTNP5/sXXBRqyRKmw+/zo7pJ74zoGneMWMdQ1CogQAenb+f7J89/fAnOB/h5+886kqC2AOZgYHhz9eXN4+uW7rzPrIg4wjMzwDAxF1/sSdIQQAAAABJRU5ErkJggg=="},98781:(e,n,t)=>{t.d(n,{Z:()=>i});const i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAGBSURBVDiNY9TX12cgFzCRrZNSzcwSEhLYxDnFlZX0LezUeP/9/vH20w+ImHNCotrzc3e/whSxYGpTc08Id9EWZ3j78vX338amPmJ8f15d3bNqwU4BNW0VhisMDC9xaOa0Sq2NUvt0aGVV85lPMEE+k/Cs8JxapaPPGRj+IKtG8TOnZ1ao4uNldR2rEDoZGBg+nVnZUbfsloSFOieqVcg2q4VbStzbXXfsO7IC7YSWTBMBGO/7b2SrGZHimdPA3vTjwUP3MYIBF2AcsESC7Gc+GQ0JLhjn94fH91+g+J7TM7dW4VrV9L3YNJtF58dpc359+eTtbwYGhjeX58/ZjqzZJNpW6e3hObhsZmD4+ekTixDD/ekTV99CtVTNNytc+9OhSSjGoWn+83jdjCf2GXltWjcP7d559cnHj6z8ynrOzhbafK92Tp+4GS0iMJLn/c295QdNAqPtnRLsBDkZGP58ennvwvrmHSdefkdXihxVnAbuFr937r+KoQYnGLh4pkgzAFQ2jEvyzQb/AAAAAElFTkSuQmCC"},59246:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/create-extension-menu-633910570ef81c9a046b12ce3c3b3805.png"},23434:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/create-extension-panel-5c9fd720b5c150ba2fcc96d1a69ef309.png"},58971:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/extension-folder-blank-d7aa3aaa435e2ff3bec86f3f7388d402.png"}}]);